{% extends "layout.html" %}

{% block title %}
    Dashboard - MyFoodBudget
{% endblock %}

{% block main %}
    <section class="container-responsive mt-4 space-y-4" aria-label="Dashboard Overview">
        <!-- Key Metrics Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-3 gap-3">
            <div class="surface border-app rounded-2xl shadow-md p-4">
                <p class="text-sm text-muted">Your Ingredients</p>
                <p class="mt-1 text-xl font-semibold">{{ ingredients_count or 0 }}</p>
                <p class="mt-1 text-sm text-muted">Items tracked</p>
            </div>
            <div class="surface border-app rounded-2xl shadow-md p-4">
                <p class="text-sm text-muted">Your Recipes</p>
                <p class="mt-1 text-xl font-semibold">{{ recipes_count or 0 }}</p>
                <p class="mt-1 text-sm text-muted">Recipes created</p>
            </div>
            <div class="surface border-app rounded-2xl shadow-md p-4">
                <p class="text-sm text-muted">Latest Addition</p>
                <p class="mt-1 text-xl font-semibold">{{ latest_ingredient_name or 'None yet' }}</p>
                <p class="mt-1 text-sm text-muted">Most recent ingredient</p>
            </div>
        </div>

        <!-- Getting Started -->
        {% if not ingredients_count and not recipes_count %}
        <div class="surface border-app rounded-2xl shadow-md p-4" aria-label="Getting Started">
            <h2 class="text-base font-semibold mb-2">Welcome to MyFoodBudget! ðŸ‘‹</h2>
            <p class="text-sm text-muted mb-3">Get started by adding your first ingredient or creating a recipe to track your food expenses and plan meals.</p>
            <div class="primary-wash rounded-xl p-3">
                <p class="text-sm font-medium">ðŸ’¡ Quick tip: Use the barcode scanner to quickly add ingredients with automatic price lookup!</p>
            </div>
        </div>
        {% endif %}

        <!-- Recent Activity -->
        {% if recent_items %}
        <div class="surface border-app rounded-2xl shadow-md p-4" aria-label="Recent Activity">
            <h2 class="text-base font-semibold mb-3">Recent Activity</h2>
            <ul class="divide-app">
                {% for item in recent_items[:3] %}
                <li class="py-2">
                    <p class="text-sm font-medium">{{ item.name }}</p>
                    <p class="text-xs text-muted mt-0.5">{{ item.type }}</p>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <!-- Quick Actions -->
        <div class="surface border-app rounded-2xl shadow-md p-4">
            <h2 class="text-base font-semibold mb-2">Quick Actions</h2>
            <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-6 gap-2">
                <button class="btn-primary" aria-label="Add Ingredient Now" onclick="window.location.href='/add_ingredient'">Add Ingredient</button>
                <button class="btn-secondary" aria-label="Create New Recipe" onclick="window.location.href='/add_meal'">Create Recipe</button>
                <button class="btn-secondary" aria-label="View All Ingredients" onclick="window.location.href='/ingredients'">View Ingredients</button>
                <button class="btn-secondary" aria-label="Scan Product" onclick="document.getElementById('scanProductBtn').click()">Scan Product</button>
            </div>
        </div>
    </section>

    <!-- Hidden button for barcode scanner modal trigger -->
    <button id="scanProductBtn" style="display: none;" data-bs-toggle="modal" data-bs-target="#scannerModal"></button>
{% endblock %}
